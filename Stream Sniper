--//UI Written By Sp00kzW4sHere

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")

-- GUI Elements
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local UsernameBox = Instance.new("TextBox")
local PlaceIdBox = Instance.new("TextBox")
local ExecuteButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")
local MinimizeButton = Instance.new("TextButton")
local UserInfoLabel = Instance.new("TextLabel")
local TargetInfoLabel = Instance.new("TextLabel")

-- Variables
local isSearching = false
local isMinimized = false
local originalSize = UDim2.new(0, 300, 0, 220)
local minimizedSize = UDim2.new(0, 300, 0, 30)

-- GUI Properties
ScreenGui.Name = "StreamSniperX"
ScreenGui.Parent = CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.BorderColor3 = Color3.fromRGB(0, 255, 0)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -110)
MainFrame.Size = originalSize
MainFrame.Active = true
MainFrame.Draggable = true

Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Title.BorderColor3 = Color3.fromRGB(0, 255, 0)
Title.Size = UDim2.new(1, -25, 0, 30)
Title.Font = Enum.Font.Code
Title.Text = "Stream Sniper X v2.0"
Title.TextColor3 = Color3.fromRGB(0, 255, 0)
Title.TextSize = 16.000

UsernameBox.Name = "UsernameBox"
UsernameBox.Parent = MainFrame
UsernameBox.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UsernameBox.BorderColor3 = Color3.fromRGB(0, 255, 0)
UsernameBox.Position = UDim2.new(0, 10, 0, 40)
UsernameBox.Size = UDim2.new(1, -20, 0, 30)
UsernameBox.Font = Enum.Font.Code
UsernameBox.PlaceholderText = "Enter Username/UserId"
UsernameBox.Text = ""
UsernameBox.TextColor3 = Color3.fromRGB(0, 255, 0)
UsernameBox.TextSize = 14.000
UsernameBox.PlaceholderColor3 = Color3.fromRGB(0, 100, 0)

PlaceIdBox.Name = "PlaceIdBox"
PlaceIdBox.Parent = MainFrame
PlaceIdBox.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
PlaceIdBox.BorderColor3 = Color3.fromRGB(0, 255, 0)
PlaceIdBox.Position = UDim2.new(0, 10, 0, 80)
PlaceIdBox.Size = UDim2.new(1, -20, 0, 30)
PlaceIdBox.Font = Enum.Font.Code
PlaceIdBox.PlaceholderText = "Place ID (Leave empty for current game)"
PlaceIdBox.Text = ""
PlaceIdBox.TextColor3 = Color3.fromRGB(0, 255, 0)
PlaceIdBox.TextSize = 14.000
PlaceIdBox.PlaceholderColor3 = Color3.fromRGB(0, 100, 0)

ExecuteButton.Name = "ExecuteButton"
ExecuteButton.Parent = MainFrame
ExecuteButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ExecuteButton.BorderColor3 = Color3.fromRGB(0, 255, 0)
ExecuteButton.Position = UDim2.new(0.5, -60, 0, 120)
ExecuteButton.Size = UDim2.new(0, 120, 0, 35)
ExecuteButton.Font = Enum.Font.Code
ExecuteButton.Text = "EXECUTE"
ExecuteButton.TextColor3 = Color3.fromRGB(0, 255, 0)
ExecuteButton.TextSize = 14.000

StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
StatusLabel.BorderColor3 = Color3.fromRGB(0, 255, 0)
StatusLabel.Position = UDim2.new(0, 10, 1, -70)
StatusLabel.Size = UDim2.new(1, -20, 0, 25)
StatusLabel.Font = Enum.Font.Code
StatusLabel.Text = "Status: Initializing..."
StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
StatusLabel.TextSize = 12.000

TargetInfoLabel.Name = "TargetInfoLabel"
TargetInfoLabel.Parent = MainFrame
TargetInfoLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
TargetInfoLabel.BorderColor3 = Color3.fromRGB(0, 255, 0)
TargetInfoLabel.Position = UDim2.new(0, 10, 1, -40)
TargetInfoLabel.Size = UDim2.new(1, -20, 0, 20)
TargetInfoLabel.Font = Enum.Font.Code
TargetInfoLabel.Text = "Target: None"
TargetInfoLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
TargetInfoLabel.TextSize = 12.000

MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = MainFrame
MinimizeButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MinimizeButton.BorderColor3 = Color3.fromRGB(0, 255, 0)
MinimizeButton.Position = UDim2.new(1, -25, 0, 0)
MinimizeButton.Size = UDim2.new(0, 25, 0, 30)
MinimizeButton.Font = Enum.Font.Code
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.fromRGB(0, 255, 0)
MinimizeButton.TextSize = 16.000

UserInfoLabel.Name = "UserInfoLabel"
UserInfoLabel.Parent = MainFrame
UserInfoLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UserInfoLabel.BorderColor3 = Color3.fromRGB(0, 255, 0)
UserInfoLabel.Position = UDim2.new(0, 10, 1, -20)
UserInfoLabel.Size = UDim2.new(1, -20, 0, 15)
UserInfoLabel.Font = Enum.Font.Code
UserInfoLabel.Text = "Made By Sp00kzW4sHere"
UserInfoLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
UserInfoLabel.TextSize = 10.000

-- Type writer effect
local function typeWrite(text, speed)
    speed = speed or 0.02
    StatusLabel.Text = ""
    for i = 1, #text do
        if not ScreenGui.Parent then break end
        StatusLabel.Text = StatusLabel.Text .. string.sub(text, i, i)
        wait(speed)
    end
end

-- Loading animation
local function loadingDots(text, times)
    for i = 1, times do
        if not ScreenGui.Parent then break end
        StatusLabel.Text = text .. string.rep(".", i % 4)
        wait(0.2)
    end
end

-- Stream sniper function
local function searchForPlayer(username, placeId)
    local userId
    local success, result = pcall(function()
        userId = tonumber(username) or Players:GetUserIdFromNameAsync(username)
        return Players:GetNameFromUserIdAsync(userId)
    end)
    
    if not success then
        typeWrite("Error: Invalid username/userId!")
        return
    end
    
    TargetInfoLabel.Text = string.format("Target: %s (%s)", result, userId)
    
    while isSearching do
        local success, servers = pcall(function()
            return HttpService:JSONDecode(game:HttpGet(
                string.format("https://games.roblox.com/v1/games/%s/servers/Public?limit=100", placeId)
            ))
        end)
        
        if success and servers.data then
            for _, server in ipairs(servers.data) do
                if not isSearching then break end
                
                typeWrite(string.format("Scanning server %s...", server.id))
                
                if table.find(server.playerTokens, userId) then
                    typeWrite("Target found! Joining server...")
                    TeleportService:TeleportToPlaceInstance(placeId, server.id)
                    return
                end
                
                wait(0.1)
            end
        end
        
        typeWrite("Searching for target...")
        wait(1)
    end
end

-- Button handlers
MinimizeButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        MainFrame.Size = minimizedSize
        UsernameBox.Visible = false
        PlaceIdBox.Visible = false
        ExecuteButton.Visible = false
        StatusLabel.Visible = false
        TargetInfoLabel.Visible = false
        UserInfoLabel.Visible = false
        MinimizeButton.Text = "+"
    else
        MainFrame.Size = originalSize
        UsernameBox.Visible = true
        PlaceIdBox.Visible = true
        ExecuteButton.Visible = true
        StatusLabel.Visible = true
        TargetInfoLabel.Visible = true
        UserInfoLabel.Visible = true
        MinimizeButton.Text = "-"
    end
end)

ExecuteButton.MouseButton1Click:Connect(function()
    isSearching = not isSearching
    if isSearching then
        local targetPlaceId = tonumber(PlaceIdBox.Text) or game.PlaceId
        ExecuteButton.Text = "STOP"
        ExecuteButton.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
        spawn(function()
            searchForPlayer(UsernameBox.Text, targetPlaceId)
        end)
    else
        ExecuteButton.Text = "EXECUTE"
        ExecuteButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        typeWrite("Operation cancelled.")
    end
end)

-- Startup sequence
spawn(function()
    local sequence = {
        {text = "Initializing stream sniper module", wait = 0.5},
        {text = "Loading player database", wait = 0.5},
        {text = "Bypassing security", wait = 0.5},
        {text = "Establishing connection", wait = 0.5},
        {text = "[!] System ready", wait = 0.5},
        {text = "Awaiting target input", wait = 0}
    }
    
    for _, step in ipairs(sequence) do
        typeWrite(step.text)
        if step.wait > 0 then
            loadingDots(step.text, math.floor(step.wait / 0.2))
        end
    end
end)

-- Hotkey support
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.RightControl then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- Cleanup
if shared.StreamSniperGui then
    shared.StreamSniperGui:Destroy()
end
shared.StreamSniperGui = ScreenGui
